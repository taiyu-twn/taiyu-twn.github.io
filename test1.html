<div id="doc" class="markdown-body container-fluid" style="position: relative;"><h1 id="A-Modular-Low-Complexity-ECG-Delineation-Algorithm-for-Real-Time-Embedded-Systems">A Modular Low-Complexity ECG Delineation Algorithm for Real-Time Embedded Systems</h1><p>IEEE JOURNAL OF BIOMEDICAL AND HEALTH INFORMATICS, VOL. 22, NO. 2, MARCH 2018</p><h1 id="摘要">摘要</h1><p><img src="https://www.researchgate.net/profile/Hiren_Kumar_Thakkar/publication/322752368/figure/fig7/AS:587730631290886@1517137310294/Example-of-ECG-feature-points-onset-points-and-offset-points.png" alt=""><br>
這個做法對於不同ECG波型的區分(QRS、P和T波、onsets和結束波型)展現了一個新的模塊化且低複雜度的演算法。包含減少每秒的運算數量和使用很少的內存空間，這個演算法的用法是在資源受限的嵌入式系統實現即時判斷。模組化設計允許演算法可以在執行時自動調整劃定品質的模式範圍和取樣率，從沒有心電異常時使用超低電量模式來用低頻率取樣，到以高頻率取樣的高精度取樣劃分模式，偵測所有ECG心率不準時的基準點。劃分演算法已經被用QT資料庫調整過了，提供非常高的靈敏度和正確預測能力，從MIT資料庫驗證。在異常判斷中，劃分的所有基準點都是從心電圖委員會高精確度模式通用標準中的公差取得，除了P波的部分，藉由一段時間的樣本，在驗證基於公差上的演算法。</p><h6 id="tags-Electrocardiogram-delineation-real-time">tags: <code>Electrocardiogram</code> <code>delineation</code> <code>real-time</code></h6><h6 id="tags-energy-constrained-systemswearable-medical-devices">tags: energy-constrained systems<code></code>wearable medical devices</h6><h1 id="I介紹">I.介紹</h1><p>ECG信號代表心臟的電子活動狀態，這是觀察心臟狀態和評估其條件非常重要的工具。大多的心電信號自動分析技術依靠特徵點，因此，準確地偵測不同的心電圖波型峰值和邊界是對完成可靠的心臟自動診斷議題是重要的。在很多狀況中(例如動態監控、可提取不同心電圖波形的即時自動化系統)是有用的。</p><p>第一個應用的技術是為了劃分ECG信號的QRS複合波基於ECG的振幅和它的一階微分。雖然這些實例是相當重要有效，並具有高靈敏度和特異性的，但他們僅限於用來偵測QRS複合波，然而，為了進行準確的ECG分析，P波和T波的邊界和峰值也是需要的。如今，基準點都已經開發有大量更先進的方法來求得。這些方法包含使用小波(使用最廣泛的技術，即使是用於檢測心電圖波形形態的心肌疤痕)、希爾伯特變換(Hilbert transform)、法則轉換(fasor transform)、動態時間扭曲(dynamic time warping)、人工神經網路(artificial neural networks)、隱馬爾可夫模型(hidden Markov models)、時域形態(time-domain morphology)、梯度演算法或型態轉換(gradient based algorithms or morphological transforms)。</p><p>這些新方法的複雜性涵蓋很高的計算成本。若是劃分在離線或沒有任何時間限制的情況下執行，他們可以非常近似於醫學註釋。然而，越來越多地使用微型嵌入式可穿戴設備進行即時健康監測和診斷，這促使人們需要更高效的演算法，以適應這些設備的低處理能力和能量消耗，同時實現醫療標準所要求的高精度。部分的裝置已經上市，例如Corventis NUVANT Mobile、Cardiac Telemetry System、Vital Connect HealthPatch MD或Preventice BodyGuardian Remote Monitoring System。然而他們他們僅限於ECG的串連或非常簡單的處理，來提取心跳等關鍵參數。</p><p>目前穿戴式設備市場穩定成長，開發能夠全天候(24/7)監測心率（HR）的新設備，使用GPS運行或監測睡眠模式和品質。健身追踪器或智能手錶可用於記錄和/或分析實時信號，而無需安裝在設備上的傳感器或胸帶。在心率的範例中，這些設備如同腕帶式設備模型或是Garmin v´ıvo系列，可以持續5至8天連續以光學方式測量心率。另一方面，如Polar M400用可穿戴設備胸帶和智慧手錶測量心率。</p><p>每年市場都有很多新產品上市，像是Cronovo ECG monitor watch，能監測血壓水準、心跳異變率、疲勞程度、自動SOS警報或睡意警報，或像是QardioCore有三導程無線ECG監控、臨床驗證、使用取樣率200Hz、16bit解析度，可連續使用兩天。對於本論文建議的即時心電圖劃分演算法將會幫助下一代可穿戴監控系統的發展，可以憑藉劃分結果在電路板上進行心電圖心律失常檢測。</p><p>為了實現這些可穿戴式嵌入式系統適合的演算法，提出了一種基於小波的即時劃分線，並強調嵌入式信號濾波的重要性，以補償在動態監測期間出現的不同信號來源或雜訊和人為干擾。在本論文中我們更進一步提出了與心跳分類演算法類似的結構，其中提供了一種簡單且高效的分類演算法，可隨時執行，以確定心電圖的哪些部分是具有關鍵性的，並且僅在這些情況下使用詳細的（並且提供更高的運算量）診斷演算法;以及在其實時硬體實現中使用濾波器和閾值來檢測ECG基準點以預測室性心律失常。因此，本文提出了一種新的劃分演算法，該演算法不僅比先進技術有更低的運算複雜度且更省效能，而且更加靈活和可模塊化，能夠持續實現能量消耗與劃分精度之間的最佳平衡，能在有限的能量和效能需求中，進行精確的心律失常檢測。</p><p>本文提出的簡單而精確的劃分演算法是對ECG信號的二階導數做截止頻率為14Hz的低通FIR濾波，也考慮雜訊濾除和消除基線飄移，雜訊濾除部分採用頻率為40Hz的低通FIR濾波器，消除基線漂移的部分則應用不同的形態濾波器。與以前的方法相比，所提出的算法的優點如下：</p><ol>
<li>在本論文中介紹的劃定算法中，取樣速率會在執行時進行調整，以降低CPU處理和ADC的運算耗能。小波技術需要重新設計濾波組合或重新取樣輸入信號(包含負樣本)，而本論文所提出的演算法只需要調整FIR濾波器的係數維持其截止頻率即可（參數可以被離線運算和被儲存在某些集合頻率中的快取記憶體中）。</li>
<li>本論文的技術能夠以幾乎沒有延遲的方式檢測心跳，所以能允許ADC關閉，直到預測下次的心跳發生的時候開啟，達到系統節能。相反，小波變換使用滑動窗口來檢測心跳，因此需要其中的所有取樣點。</li>
<li>如果不需要完整劃分，例如心率是正常的，受試者沒有病症，模塊化的算法法允許一些部分被禁用，因此大大減少了運算負擔。如果給定的心臟狀況（例如檢測到心動過速或心動過緩），系統也會自動啟用所有模塊。在小波方法中，大部分CPU容量用於計算比例，例如R峰值偵測就用了大部分的容量，未檢測其他基準點不會顯著減輕CPU負擔。</li>
</ol><p>本論文的其餘部分如下。第二部分介紹劃分演算法建議的模組化設計，包含一個演算法其根據心率變化自動改變取樣品質的研究案例。第三部分描述了MSPSim演算法的實現，並提供了它的性能評估，以及與其他最先進技術的比較研究。第四部分為這項論文的結論。</p><h1 id="II心電圖劃分演算法">II.心電圖劃分演算法</h1><p>EGG信號呈現不同的波形，每個波形都與心動週期的生理階段有關。如Fig.1 所示，心跳可以分為三個主要部分：P波、QRS複合波和T波。 P波表示開始並且代表心房去極化。 QRS複合波的是一組三個連續的波並相應<br>
到心室去極化。最後，T波表示心室復極。<br>
<img src="https://i.imgur.com/3tcROTC.png" alt=""><br>
在這裡採用一種新的模塊化演算法來檢測不同的心電波（P，QRS和T）及描述其基準點（峰值，起始和結束）被。檢測ECG波形的偵測演算法總結如下（Fig.2）：<br>
<img src="https://i.imgur.com/zEeb6RS.png" alt=""></p><ol>
<li>劃分演算法從QRS峰開始。</li>
<li>檢測到一個QRS峰值後，其邊界（開始和結束）就能在複合波之前和之後被找到。</li>
<li>P和T也可以在QRS前後被找到，然後同樣找P和T的起始和終止時間。</li>
</ol><p>當取得原始ECG信號時，高頻雜訊、人為造成的肌肉運動和基線漂移都可能存在。這些干擾需要在使用劃分演算法之前去除，以確保檢測基準點的準確性。Fig.3 為ECG信號進行劃定演算法時的流程圖。 Peaks模塊（左）是用於檢測QRS波峰以及可選的P和T峰。 On-end模塊（右側）可用於描繪如果需要，ECG波的起始和結束。 On-end模塊細分為三個完全獨立的模塊模塊：QRS端到端模塊，P端模塊和可根據需要啟用或禁用T端模塊。<br>
<img src="https://i.imgur.com/zd0J7hU.png" alt=""></p><h2 id="A-Peaks-Module">A. Peaks Module</h2><p>主要為檢測QRS波的波峰，甚至可以檢測P和T波的波峰。<br>
將截止頻率為14Hz的低通FIR濾波器應用於<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-694-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mi>a</mi><mi>w</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7717" style="width: 4.151em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.559em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1003.56em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-7718"><span class="mi" id="MathJax-Span-7719" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7720" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-7721"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-7722" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-7723"><span class="mrow" id="MathJax-Span-7724"><span class="mi" id="MathJax-Span-7725" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-7726" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-7727" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>a</mi><mi>w</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-694">ECG_{raw}</script></span>信號。使用這種強大的濾波器，可以消除任何類型的高頻信號，同時保留P、QRS和T波峰位置，如Fig.4中的<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-695-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7728" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-7729"><span class="mi" id="MathJax-Span-7730" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7731" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-7732"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-7733" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-7734"><span class="mrow" id="MathJax-Span-7735"><span class="mi" id="MathJax-Span-7736" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-7737" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-7738" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-695">ECG_{LP14}</script></span>信號。因此，<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-696-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7739" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-7740"><span class="mi" id="MathJax-Span-7741" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7742" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-7743"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-7744" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-7745"><span class="mrow" id="MathJax-Span-7746"><span class="mi" id="MathJax-Span-7747" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-7748" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-7749" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-696">ECG_{LP14}</script></span>用於查找P，T波和QRS波群，由於他有使用閥值的概念，因此無法檢測到更小的低能波，如Q、S.<br>
<img src="https://i.imgur.com/bFfQpAx.png" alt=""><br>
雖然IIR濾波器比起FIR濾波器可以使用更少的接頭、記憶體和運算子來實現信號濾波，但它更容易受到數值穩定性問題的影響。因此，選擇FIR濾波器是因為它們更容易實時實現（較低的複雜度），並且它們的穩定性也被證實了，雖然他需要更多的樣本來做信號處理而且會有比較高的信號延遲發生(N-order FIR 濾波器產生N/2 samples的延遲時間)。<br>
QRS的劃分採用<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-697-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7750" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-7751"><span class="mi" id="MathJax-Span-7752" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7753" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-7754"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-7755" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-7756"><span class="mrow" id="MathJax-Span-7757"><span class="mi" id="MathJax-Span-7758" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-7759" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-7760" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-697">ECG_{LP14}</script></span>信號的最高峰。由於QRS波群的形狀取決於所選導聯的方向，因此最顯著的峰是某些導聯（如V6）的R波或其他導聯（如V1）的S波，其中隨後出現一個小的R峰由大負偏轉（S波）。在本文中，我們將前QRS複合波定義為正值，後者定義為負值。<br>
為了偵測QRS波群的峰值，運算一階和二階微分。如Fig. 5(a)，對於正QRS波峰，二階導數總是負值，其值在峰值附近大於（在絕對值上）比其餘節拍中的值，並且一階導數穿過零線。在負QRS波峰的情況下，二階導數總是正的。正常心電圖描繪在Fig. 6中，包含正負QRS波群。<br>
<img src="https://i.imgur.com/DvDNTit.png" alt=""><br>
<img src="https://i.imgur.com/RIoNvmQ.png" alt=""><br>
QRS偵測峰值的第一步是選擇一段濾波後的ECG信號（來自<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-698-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7761" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-7762"><span class="mi" id="MathJax-Span-7763" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7764" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-7765"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-7766" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-7767"><span class="mrow" id="MathJax-Span-7768"><span class="mi" id="MathJax-Span-7769" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-7770" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-7771" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-698">ECG_{LP14}</script></span>），其大小至少包含一次心跳;將這段信號存儲在一個2秒的循環緩衝區（也稱為window）中，並以新的ECG取樣做更新。緩衝長度為2秒的長度可允許心率低至每分鐘30次。每當2秒window（或循環緩衝區）完成時，找到二階導數的最大值<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-699-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mi>E</mi><mi>C</mi><msubsup><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>14</mn></mrow><mo>&amp;#x2033;</mo></msubsup><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7772" style="width: 8.893em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.654em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1007.55em, 2.858em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-7773"><span class="mo" id="MathJax-Span-7774" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7775" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-7776" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-7777" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-7778" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7779" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7780" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-7781"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-7782" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.451em, 1000.49em, 4.098em, -999.997em); top: -4.308em; left: 0.811em;"><span class="mo" id="MathJax-Span-7783" style="font-size: 70.7%; font-family: MathJax_Main;">′′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.78em, 4.151em, -999.997em); top: -3.661em; left: 0.811em;"><span class="texatom" id="MathJax-Span-7784"><span class="mrow" id="MathJax-Span-7785"><span class="mi" id="MathJax-Span-7786" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-7787" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-7788" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-7789" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-7790" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>E</mi><mi>C</mi><msubsup><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>14</mn></mrow><mo>″</mo></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-699">(max(ECG''_{LP14}))</script></span>和最小值<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-700-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>(</mo><mi>E</mi><mi>C</mi><msubsup><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>14</mn></mrow><mo>&amp;#x2033;</mo></msubsup><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7791" style="width: 8.731em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.492em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1007.38em, 2.858em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-7792"><span class="mo" id="MathJax-Span-7793" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7794" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-7795" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-7796" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-7797" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7798" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7799" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-7800"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-7801" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.451em, 1000.49em, 4.098em, -999.997em); top: -4.308em; left: 0.811em;"><span class="mo" id="MathJax-Span-7802" style="font-size: 70.7%; font-family: MathJax_Main;">′′</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.343em, 1001.78em, 4.151em, -999.997em); top: -3.661em; left: 0.811em;"><span class="texatom" id="MathJax-Span-7803"><span class="mrow" id="MathJax-Span-7804"><span class="mi" id="MathJax-Span-7805" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-7806" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-7807" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-7808" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-7809" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>E</mi><mi>C</mi><msubsup><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>14</mn></mrow><mo>″</mo></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-700">(min(ECG''_{LP14}))</script></span>來計算將在稍後使用的值。最後，最後5個值的移動平均值（AvgQRS）將在稍後用於計算閾值以檢測QRS波峰;每當新窗口完成時，此閾值就會更新。</p><p>當滿足以下條件時（在每一個新ECG樣本獲得時評估），在環形緩衝區內偵測到QRS峰值：</p><ol>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1618-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21799" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-21800"><span class="mi" id="MathJax-Span-21801" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21802" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-21803"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21804" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-21805"><span class="mrow" id="MathJax-Span-21806"><span class="mi" id="MathJax-Span-21807" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-21808" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-21809" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-1618">ECG_{LP14}</script></span>的一階導數的符號必須改變（標記為<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1619-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><msub><mn>14</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>,</mo><mi>s</mi><mi>c</mi></mrow></msub></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21810" style="width: 5.498em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.744em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.74em, 2.912em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-21811"><span class="mi" id="MathJax-Span-21812" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21813" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-21814"><span style="display: inline-block; position: relative; width: 3.235em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21815" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-21816"><span class="mrow" id="MathJax-Span-21817"><span class="mi" id="MathJax-Span-21818" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-21819" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-21820"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.343em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mn" id="MathJax-Span-21821" style="font-size: 70.7%; font-family: MathJax_Main;">14</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.877em; left: 0.703em;"><span class="texatom" id="MathJax-Span-21822"><span class="mrow" id="MathJax-Span-21823"><span class="mo" id="MathJax-Span-21824" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21825" style="font-size: 50%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-21826" style="font-size: 50%; font-family: MathJax_Math-italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><msub><mn>14</mn><mrow class="MJX-TeXAtom-ORD"><mo>,</mo><mi>s</mi><mi>c</mi></mrow></msub></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-1619">ECG_{LP14_{,sc}}</script></span>如Fig.3）。這表示濾波的ECG信號中存在局部最大值或最小值。</li>
<li><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1620-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21827" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-21828"><span class="mi" id="MathJax-Span-21829" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-21830" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-21831"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21832" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-21833"><span class="mrow" id="MathJax-Span-21834"><span class="mi" id="MathJax-Span-21835" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-21836" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-21837" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-1620">ECG_{LP14}</script></span>的二階導數的幅度（絕對值）必須大於閾值 <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1621-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>Q</mi><mi>R</mi><msub><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msub><mo>=</mo><mi>Q</mi><mi>R</mi><msub><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>&amp;#xB7;</mo><mi>A</mi><mi>v</mi><msub><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mi>R</mi><mi>S</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21838" style="width: 15.466em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.311em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1013.2em, 2.858em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-21839"><span class="mo" id="MathJax-Span-21840" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-21841" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-21842" style="font-family: MathJax_Math-italic;">R</span><span class="msubsup" id="MathJax-Span-21843"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21844" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-21845"><span class="mrow" id="MathJax-Span-21846"><span class="mi" id="MathJax-Span-21847" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-21848" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-21849" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-21850" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">Q</span><span class="mi" id="MathJax-Span-21851" style="font-family: MathJax_Math-italic;">R</span><span class="msubsup" id="MathJax-Span-21852"><span style="display: inline-block; position: relative; width: 2.697em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21853" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-21854"><span class="mrow" id="MathJax-Span-21855"><span class="mi" id="MathJax-Span-21856" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-21857" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-21858" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-21859" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-21860" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-21861" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-21862" style="font-family: MathJax_Main; padding-left: 0.218em;">⋅</span><span class="mi" id="MathJax-Span-21863" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">A</span><span class="mi" id="MathJax-Span-21864" style="font-family: MathJax_Math-italic;">v</span><span class="msubsup" id="MathJax-Span-21865"><span style="display: inline-block; position: relative; width: 2.104em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21866" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-21867"><span class="mrow" id="MathJax-Span-21868"><span class="mi" id="MathJax-Span-21869" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-21870" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span class="mi" id="MathJax-Span-21871" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-21872" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>Q</mi><mi>R</mi><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msub><mo>=</mo><mi>Q</mi><mi>R</mi><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>·</mo><mi>A</mi><mi>v</mi><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>Q</mi><mi>R</mi><mi>S</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1621">(QRS_{th} = QRS_{factor}·Avg_{QRS})</script></span>，其中<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1622-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mi>R</mi><msub><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>=</mo><mn>0.33</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21873" style="width: 8.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.33em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1007.28em, 2.858em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-21874"><span class="mi" id="MathJax-Span-21875" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-21876" style="font-family: MathJax_Math-italic;">R</span><span class="msubsup" id="MathJax-Span-21877"><span style="display: inline-block; position: relative; width: 2.697em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21878" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-21879"><span class="mrow" id="MathJax-Span-21880"><span class="mi" id="MathJax-Span-21881" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-21882" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-21883" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-21884" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-21885" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-21886" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-21887" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-21888" style="font-family: MathJax_Main; padding-left: 0.272em;">0.33</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mi>R</mi><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>=</mo><mn>0.33</mn></math></span></span><script type="math/tex" id="MathJax-Element-1622">QRS_{factor} = 0.33</script></span>稍後會有證明，而<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1623-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mi>v</mi><msub><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mi>R</mi><mi>S</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21889" style="width: 3.882em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.343em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1003.34em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-21890"><span class="mi" id="MathJax-Span-21891" style="font-family: MathJax_Math-italic;">A</span><span class="mi" id="MathJax-Span-21892" style="font-family: MathJax_Math-italic;">v</span><span class="msubsup" id="MathJax-Span-21893"><span style="display: inline-block; position: relative; width: 2.104em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21894" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-21895"><span class="mrow" id="MathJax-Span-21896"><span class="mi" id="MathJax-Span-21897" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-21898" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span class="mi" id="MathJax-Span-21899" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mi>v</mi><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>Q</mi><mi>R</mi><mi>S</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-1623">Avg_{QRS}</script></span>之前被定義為最後五個最小或最大window值的移動平均值，因此，<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1624-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21900" style="width: 1.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.51em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-21901"><span class="msubsup" id="MathJax-Span-21902"><span style="display: inline-block; position: relative; width: 1.511em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21903" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.757em;"><span class="texatom" id="MathJax-Span-21904"><span class="mrow" id="MathJax-Span-21905"><span class="mi" id="MathJax-Span-21906" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-21907" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-1624">R_{th}</script></span>每2秒更新一次（每次在新的2秒window行程後更新<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1625-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mi>v</mi><msub><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mi>R</mi><mi>S</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21908" style="width: 3.882em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.343em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1003.34em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-21909"><span class="mi" id="MathJax-Span-21910" style="font-family: MathJax_Math-italic;">A</span><span class="mi" id="MathJax-Span-21911" style="font-family: MathJax_Math-italic;">v</span><span class="msubsup" id="MathJax-Span-21912"><span style="display: inline-block; position: relative; width: 2.104em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21913" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-21914"><span class="mrow" id="MathJax-Span-21915"><span class="mi" id="MathJax-Span-21916" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-21917" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span class="mi" id="MathJax-Span-21918" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mi>v</mi><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>Q</mi><mi>R</mi><mi>S</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-1625">Avg_{QRS}</script></span>）以動態地使算法適應新的一段ECG。應該注意的是<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1626-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mi>R</mi><msub><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21919" style="width: 4.96em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.259em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.26em, 2.858em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-21920"><span class="mi" id="MathJax-Span-21921" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-21922" style="font-family: MathJax_Math-italic;">R</span><span class="msubsup" id="MathJax-Span-21923"><span style="display: inline-block; position: relative; width: 2.697em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.65em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-21924" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-21925"><span class="mrow" id="MathJax-Span-21926"><span class="mi" id="MathJax-Span-21927" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-21928" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-21929" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-21930" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-21931" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-21932" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mi>R</mi><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-1626">QRS_{factor}</script></span>應該在0和1之間。</li>
<li>連續QRS波峰兩個之間的時差必須大於250ms。這個時間間隔允許檢測高達每分鐘240次的心率。</li>
</ol><p>針對每個新ECG樣本的輸入來評估檢測QRS峰值的條件。應該注意的是，FIR濾波器，形態濾波器和導數運算與串流資料在取樣和運算後都有已知的延遲。一旦偵測到QRS峰，根據需要劃定P和T峰，在2個連續的QRS峰之間搜索它們（前一次的T波，與這次的P波）。</p><p>P波是波型中的第一波。在正常患者在120ms附近，例如有心房纖顫史的患者，長達170ms。另外，PR間隔（Fig.1）在120 ms和200 ms之間。由於這個原因，劃分演算法在QRS波峰之前的100ms和200ms之間的時間窗口中尋找可能的P峰值，永遠不會超過當前QRS峰值和前一波形之間一半的時間，以避免混淆波以前的心跳為當前的P波。</p><p>一個P波峰值的候選點，必為<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2174-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31879" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-31880"><span class="mi" id="MathJax-Span-31881" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-31882" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-31883"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-31884" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-31885"><span class="mrow" id="MathJax-Span-31886"><span class="mi" id="MathJax-Span-31887" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-31888" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-31889" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2174">ECG_{LP14}</script></span>的二階導數中的搜索window中的最小值或最大值（如Fig.5（b）），並超過某個閾值<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2175-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msub><mo>=</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>&amp;#xB7;</mo><mi>A</mi><mi>v</mi><msub><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mi>R</mi><mi>S</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31890" style="width: 11.91em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.24em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1010.13em, 2.858em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-31891"><span class="mo" id="MathJax-Span-31892" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-31893"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-31894" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-31895"><span class="mrow" id="MathJax-Span-31896"><span class="mi" id="MathJax-Span-31897" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-31898" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-31899" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-31900" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.697em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-31901" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-31902"><span class="mrow" id="MathJax-Span-31903"><span class="mi" id="MathJax-Span-31904" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-31905" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-31906" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-31907" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-31908" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-31909" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-31910" style="font-family: MathJax_Main; padding-left: 0.218em;">⋅</span><span class="mi" id="MathJax-Span-31911" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">A</span><span class="mi" id="MathJax-Span-31912" style="font-family: MathJax_Math-italic;">v</span><span class="msubsup" id="MathJax-Span-31913"><span style="display: inline-block; position: relative; width: 2.104em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1000.49em, 4.367em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-31914" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.488em;"><span class="texatom" id="MathJax-Span-31915"><span class="mrow" id="MathJax-Span-31916"><span class="mi" id="MathJax-Span-31917" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-31918" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span class="mi" id="MathJax-Span-31919" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-31920" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msub><mo>=</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>·</mo><mi>A</mi><mi>v</mi><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>Q</mi><mi>R</mi><mi>S</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2175">(P_{th} = P_{factor}·Avg_{QRS})</script></span>，與QRS峰值偵測的程序類似。對於正常或正P波，使用二階導數絕對值的最小值會比最大值來的好，而對於異常或負P波，絕對值的最大值比最小值佳。在這種情況下，使用閾值避免錯誤偵測，根據經驗選擇為已<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2176-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31921" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-31922"><span class="mi" id="MathJax-Span-31923" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-31924" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-31925"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-31926" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-31927"><span class="mrow" id="MathJax-Span-31928"><span class="mi" id="MathJax-Span-31929" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-31930" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-31931" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>14</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2176">ECG_{LP14}</script></span>的二階導數的1％做為QRS峰值位置<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2177-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>=</mo><mn>0.01</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31932" style="width: 7.654em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.576em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1006.47em, 2.858em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-31933"><span class="mo" id="MathJax-Span-31934" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-31935"><span style="display: inline-block; position: relative; width: 2.697em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-31936" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.649em;"><span class="texatom" id="MathJax-Span-31937"><span class="mrow" id="MathJax-Span-31938"><span class="mi" id="MathJax-Span-31939" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-31940" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-31941" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-31942" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-31943" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-31944" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-31945" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-31946" style="font-family: MathJax_Main; padding-left: 0.272em;">0.01</span><span class="mo" id="MathJax-Span-31947" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>=</mo><mn>0.01</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2177">(P_{factor} = 0.01)</script></span>中，並且在下一節中將被證明是合理的。如果這個條件沒有得到滿足，P波就不會被標出來。</p><p>心跳的最後一個特徵波是T波。對於正常的T波，QT間隔必須短於425ms，T波持續時間從125ms到200 ms。在這些情況下，劃分演算法在QRS複合波之後200ms和400ms之間的時間間隔內搜索T波的峰值，並且絕不超過當前QRS峰值和下一波峰值之間一半的時間。</p><p>檢測T波的過程與之前解釋的P波檢測完全相同。此外，使用的閾值是<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2189-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>&amp;#xB7;</mo><mi>A</mi><mi>v</mi><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mi>R</mi><mi>S</mi></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32242" style="width: 11.587em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.97em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1009.97em, 2.858em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-32243"><span class="msubsup" id="MathJax-Span-32244"><span style="display: inline-block; position: relative; width: 1.35em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-32245" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-32246"><span class="mrow" id="MathJax-Span-32247"><span class="mi" id="MathJax-Span-32248" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-32249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">h</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-32250" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="msubsup" id="MathJax-Span-32251" style="padding-left: 0.272em;"><span style="display: inline-block; position: relative; width: 2.643em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-32252" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-32253"><span class="mrow" id="MathJax-Span-32254"><span class="mi" id="MathJax-Span-32255" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-32256" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-32257" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-32258" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-32259" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-32260" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-32261" style="font-family: MathJax_Main; padding-left: 0.218em;">⋅</span><span class="mi" id="MathJax-Span-32262" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">A</span><span class="mi" id="MathJax-Span-32263" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-32264" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-32265"><span class="mrow" id="MathJax-Span-32266"><span class="mi" id="MathJax-Span-32267" style="font-family: MathJax_Math-italic;">Q</span><span class="mi" id="MathJax-Span-32268" style="font-family: MathJax_Math-italic;">R</span><span class="mi" id="MathJax-Span-32269" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>h</mi></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>·</mo><mi>A</mi><mi>v</mi><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>Q</mi><mi>R</mi><mi>S</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-2189">T_{th} = T_{factor}·Avg{QRS}</script></span>，<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2190-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>=</mo><mn>0.01</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32270" style="width: 6.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.714em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1005.66em, 2.858em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-32271"><span class="msubsup" id="MathJax-Span-32272"><span style="display: inline-block; position: relative; width: 2.643em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.7em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-32273" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-32274"><span class="mrow" id="MathJax-Span-32275"><span class="mi" id="MathJax-Span-32276" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-32277" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-32278" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-32279" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-32280" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-32281" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-32282" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-32283" style="font-family: MathJax_Main; padding-left: 0.272em;">0.01</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>=</mo><mn>0.01</mn></math></span></span><script type="math/tex" id="MathJax-Element-2190">T_{factor} = 0.01</script></span>，將在下一節討論。</p><h2 id="B-On-End-Module">B. On-End Module</h2><p>與Peaks模塊同步執行的On-end模塊可用於檢測以前檢測到的ECG波的起始點和結束點。這是一個不太具有侵略性的低通FIR濾波器應用於<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2229-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mi>a</mi><mi>w</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32720" style="width: 4.151em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.559em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1003.56em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-32721"><span class="mi" id="MathJax-Span-32722" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-32723" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-32724"><span style="display: inline-block; position: relative; width: 2.05em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-32725" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-32726"><span class="mrow" id="MathJax-Span-32727"><span class="mi" id="MathJax-Span-32728" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-32729" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-32730" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>a</mi><mi>w</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2229">ECG_{raw}</script></span>，截止頻率為40Hz（信號<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2230-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>40</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32731" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-32732"><span class="mi" id="MathJax-Span-32733" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-32734" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-32735"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-32736" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-32737"><span class="mrow" id="MathJax-Span-32738"><span class="mi" id="MathJax-Span-32739" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-32740" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-32741" style="font-size: 70.7%; font-family: MathJax_Main;">40</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>40</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2230">ECG_{LP40}</script></span>）。該FIR濾波器可清除保存ECG波形的高頻雜訊，因此<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2231-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>40</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32742" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-32743"><span class="mi" id="MathJax-Span-32744" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-32745" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-32746"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-32747" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-32748"><span class="mrow" id="MathJax-Span-32749"><span class="mi" id="MathJax-Span-32750" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-32751" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-32752" style="font-size: 70.7%; font-family: MathJax_Main;">40</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>40</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2231">ECG_{LP40}</script></span>適用於檢測ECG波的起點和終點。</p><h3 id="1-QRS-on-End-Module">1) QRS-on-End Module</h3><p>為了能夠檢測心電圖起點和終點，必須從<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2255-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>40</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-33006" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-33007"><span class="mi" id="MathJax-Span-33008" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-33009" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-33010"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-33011" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-33012"><span class="mrow" id="MathJax-Span-33013"><span class="mi" id="MathJax-Span-33014" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-33015" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-33016" style="font-size: 70.7%; font-family: MathJax_Main;">40</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>40</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2255">ECG_{LP40}</script></span>中去除心電圖基線漂移。為此，將<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2256-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mi>P</mi><mn>40</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-33017" style="width: 4.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.098em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.1em, 2.697em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-33018"><span class="mi" id="MathJax-Span-33019" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-33020" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="msubsup" id="MathJax-Span-33021"><span style="display: inline-block; position: relative; width: 2.589em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-33022" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.811em;"><span class="texatom" id="MathJax-Span-33023"><span class="mrow" id="MathJax-Span-33024"><span class="mi" id="MathJax-Span-33025" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-33026" style="font-size: 70.7%; font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mn" id="MathJax-Span-33027" style="font-size: 70.7%; font-family: MathJax_Main;">40</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>C</mi><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mi>P</mi><mn>40</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2256">ECG_{LP40}</script></span>送往高通濾波器到產生ECGbaseline信號（ECGbase）的高通濾波器。使用FIR濾波器或形態濾波器的方法可以在大多數技術中的其他研究中找到，以消除ECG基線漂移。在本文中，使用了描述的形態濾波。<br>
In order to do so, ECGLP 40 is fed to a highpass filter producing the ECGbaseline signal (ECGbase ). Methods using FIR filters or morphological filters can be found in other studies among most techniques to remove the ECG baseline wander. In this paper, morphological filtering described in is used.</p><p>This filter consist of two basic morphological operations: opening, f ◦ Bop = f  Bop ⊕ Bop , (that removes peaks from the signal) and closing, f • Bcl = f ⊕ Bcl  Bcl , (removes valleys), where f is the signal to be filtered, B denotes a horizontal line segment of zero amplitude, and  and ⊕ correspond with the erosion and dilation operands respectively. The length of Bop is chosen as 0.2 s because this value is greater than the width of the characteristic waves of the ECG signal (P, Q, R, S and T wave, individually). The length of Bcl should be longer than the length of Bop , typically it is selected to be 1.5 times the length of Bop , therefore 0.3 s is chosen. Each operation introduces a delay that is equal to half of the window length used, thus the morphological filter has a total delay of 0.5 s.</p><p>This type of filter presents a lower computational cost than other techniques since it only requires to find the largest or smallest value in an array of B values. An example of ECGbase (Baseline wander) along with opening and closing operations is shown in Fig. 7.</p><p>In the vicinity of a QRS peak, the ECG baseline wander (ECGbase ) is used to detect its onset and end. Supposing a positive QRS complex, the QRS peak is an R peak. Theoretically, the crossing of ECGLP 40 with ECGbase determines two characteristic points: the previous crossing would be the onset of the R wave and the later crossing would be the end of the R wave.</p><p>However, the ECGLP 40 might not cross ECGbase near the R wave, especially if the Q or S waves are absent (Fig. 8). To prevent that the algorithm fails to detect the onset and end properly, these points are selected as5%of theRwave amplitude instead of the true baseline crossings, where the amplitude is defined as the difference between ECGLP 40 and ECGbase in the R peak position.</p><p>Once the onset of the R wave is found, a Q wave may be detected before the onset of the R wave. If the Q wave is present, it is smaller than the R wave and its duration does not exceed 20/25 ms in a normal Q wave [29]. To consider the existence of a Q wave, three rules have to be met:</p><ol>
<li>The wave is found before an R wave and is negative.</li>
<li>Its duration is less than 100 ms.</li>
<li>Its amplitude is greater than 5% of the R wave amplitude. This value is chosen empirically and detections below this value are considered as variations due to noise.</li>
</ol><p>Finally, if aQwave is detected, the first crossing ofECGLP 40 withECGbase determines the onset of the Q wave. That point is also annotated as the onset of the QRS complex. Nevertheless, if the algorithm does not detect the existence of a Q wave, the onset of the R wave is annotated as the onset of the QRS complex. In order to improve the final positioning of the QRS<br>
complex onset, the algorithm searches for a local maximum of ECGLP 40 in the previous 20 ms. If such maximum exists, the onset of the QRS complex is updated to that new position.</p><p>If an R wave is detected, a S wave may follow it. The requirements of considering S waves and the treatment are the same as for Q waves. The only difference is that the search occurs (in time) after R peaks instead of before. If a S wave is annotated, the end of the S wave is also the end of the QRS complex. Otherwise, the end of the R wave is the end of the QRS complex.</p><p>In case of negative QRS complexes, the detection is analogous, but the QRS peak corresponds to an S wave and the algorithm looks for positive deflections (R waves) before and after that S wave.<br>
<img src="https://i.imgur.com/tPutbjp.png" alt=""><br>
<img src="https://i.imgur.com/pUnikNO.png" alt=""></p><h3 id="2-P-on-End-Module">2) P-on-End Module</h3><p>To detect the onset and end of the P wave, the crossings of ECGLP 40 with the baseline have to be found (to the left and right of the peak, respectively). For this purpose, the Pbase signal (see Fig. 3) is used. This signal is obtained by applying the morphological operation defined previously as opening (II-B1) to ECGLP 40, which removes the peaks of the signal, in the same way as in ECGbase . However, the length of the segmentBop in this case differs. Since a normal P wave has a maximum length of 120 ms, the length of Bop must be in agreement with this physiological property. Choosing Bop = 120 ms, opening removes peaks whose width is less than this time and makes a good approximation to the baseline of a P wave.</p><p>As well as for a QRS complex, the onset and end of a P wave are, theoretically, the crossings of ECGLP 40 with Pbase . However, it may be possible that these crossings do not take place near the peak of the P wave. For this reason, the onset and end are defined as the first local minima (to the left and right of the peak, respectively) found in ECGLP 40 for which the difference between ECGLP 40 and Pbase is between 50% and 2.5% of the amplitude of the P wave, defined as the difference between ECGLP 40 and Pbase in the P peak position.</p><h3 id="3-T-End-Module">3) T-End Module</h3><p>As in the detection of the onset and end of the P wave, the baseline of the T wave (Tbase ) is needed (see Fig. 3). This signal is computed using the opening operation (IIB1) with a Bop = 200 ms, as a normal T wave must not exceed 200 ms. The crossing of ECGLP 40 with Tbase to the right of the peak of the T wave should determine the end. However, as in P waves, this point has been redefined as the first local minima found in ECGLP 40 for which the difference between ECGLP 40 and Tbase is between 50% and 2.5% of the T wave amplitude, in order to obtain better results. The algorithm is able to detect both types of T waves, normal and abnormal, although biphasic T waves may not be accurately detected.<br>
A complete result of the ECG delineation described is shown in Fig. 9. This excerpt corresponds to the sel16539 record obtained from the QT database.<br>
<img src="https://i.imgur.com/4nedVfe.png" alt=""></p><h2 id="C-Validation-of-the-Algorithm">C. Validation of the Algorithm</h2><p><img src="https://i.imgur.com/DgY5b4x.png" alt=""></p><h2 id="D-Adjusting-the-Algorithm-Parameters">D. Adjusting the Algorithm Parameters</h2><p><img src="https://i.imgur.com/rBVQFGs.png" alt=""></p><h2 id="E-Computational-Cost-Versus-Accuracy-Tradeoff">E. Computational Cost Versus Accuracy Tradeoff</h2><p><img src="https://i.imgur.com/ocgAavQ.png" alt=""><br>
<img src="https://i.imgur.com/yaZN8MK.png" alt=""></p><h1 id="III實驗結果">III.實驗結果</h1><h2 id="A-Comparison-With-Other-Methods">A. Comparison With Other Methods</h2><p><img src="https://i.imgur.com/EsI90nI.png" alt=""></p><h2 id="B-MIT-BIH-Arrhythmia-Database">B. MIT-BIH Arrhythmia Database</h2><p><img src="https://i.imgur.com/vbdxk3V.png" alt=""><br>
<img src="https://i.imgur.com/BEUKmUw.png" alt=""></p><h3 id="1-Noise">1) Noise</h3><h2 id="C-Estimated-Number-of-Arithmetic-Operations">C. Estimated Number of Arithmetic Operations</h2><h3 id="1-FIR-Filtering">1) FIR Filtering</h3><h3 id="2-Morphological-Filtering">2) Morphological Filtering</h3><h2 id="D-Real-Time-Simulation">D. Real-Time Simulation</h2><p><img src="https://i.imgur.com/C0kvPwZ.png" alt=""></p><h1 id="IV-總結">IV. 總結</h1><p>In this paper, a new simple, modular and effective algorithm has been developed to delineate and locate the peaks and boundaries of the different ECG waves, such as the P wave, the QRS complex and the T wave, featuring low computational cost and mathematical complexity while achieving similar or better accuracy than other more advanced and computationally intensive state-of-the-art techniques.The algorithm is conceived as a modular design, in which the Peaks module delineates the ECG peaks, computing the first and second derivatives of an aggressive low-pass filtered signal, and the On-end module detects the onsets and ends of the peaks, using a less aggressive low-pass filter and morphological filters.<br>
To validate the performance of the proposed algorithm, the QT and MIT-BIH databases have been delineated and the results have been compared with annotations made by cardiologists for these databases. Results show sensitivity higher than 98% when detecting the ECG wave peaks and 96% for onsets and ends, and better positive predictive value in contrast to more complex techniques as, for example,wavelets or fasor ransform.<br>
Moreover, the errors in the delineation of all the fiducial points are below the tolerances given by the Common Standards for Electrocardiography (CSE) committee, except for the P wave onset, for which the algorithm is above the agreed tolerances by only a fraction of the sample duration.<br>
The presented algorithm has the advantage of being highly adaptive and modular. The system is able to automatically modify the sampling rate or to disable some modules of the algorithm such as for P or T wave detectors, or the detection of onsets and ends of the ECG waves, depending whether a complete delineation is needed, because an abnormal cardiac event is detected, or performing a reduced delineation the rest of the time for energy saving. This flexibility allows the algorithm to be able to operate in different modes dealing with the tradeoff between delineation accuracy and energy consumption. The proposed technique has been implemented in a simulated commercial WBSN platform to analyze its computational burden and memory footprint showing that it can perform a complete high-accuracy real-time ECG delineation with a computational burden of 8.5% (8.6 weeks of battery lifetime just considering data acquisition and processing), similar to thewavelet approach in, and also a real-time detection of only the QRS peaks, reducing the computational load to only 0.2% (31 weeks of battery lifetime) and achieving 70% power saving with respect to a complete delineation.<br>
The system can also be configured to automatically switch between modes, denoted as Adaptivemode, in order to perform a full high-accuracy delineation during arrhythmias and a limited ultra-low power detection when no arrhythmia is detected. This mode has a combined computational load of 1.3% (21.7 weeks of battery lifetime).<br>
Its low complexity, modularity in the delineation, low-power consumption, as well as its easy and quick adaptability to the ECG sampling rate, offer a great flexibility and qualify the proposed algorithm as an useful tool for embedded medical devices with limited resources for real-time applications.</p><h1 id="參考文獻">參考文獻</h1><p>[1] J. Pan and W. J. Tompkins, “A real-time QRS detection algorithm,” IEEE<br>
Trans. Biomed. Eng., vol. BME-32, no. 3, pp. 230–236, Mar. 1985.<br>
[2] V. Bono et al., “Development of an automated updated selvester QRS scoring system using SWT-based QRS fractionation detection and classification,” IEEE J. Biomed. Health Informat., vol. 18, no. 1, pp. 193–204, Jan. 2014.<br>
[3] C. Li, C. Zheng, and C. Tai, “Detection of ECG characteristic points using wavelet transforms,” IEEE Trans. Biomed. Eng., vol. 42, no. 1, pp. 21–28, Jan. 1995.<br>
[4] J. Sahambi, S. Tandon, and R. Bhatt, “Using wavelet transforms for ECG characterization. An on-line digital signal processing system,” IEEE Eng.<br>
Med. Biol. Mag., vol. 16, no. 1, pp. 77–83, Jan./Feb. 1997.<br>
[5] J. P. Mart´ınez, R. Almeida, S. Olmos, A. P. Rocha, and P. Laguna, “A wavelet-based ECG delineator: Evaluation on standard databases,” IEEE Trans. Biomed. Eng., vol. 51, no. 4, pp. 570–581, Apr. 2004.<br>
[6] D. Benitez, P. Gaydecki, A. Zaidi, and A. Fitzpatrick, “The use of the hilbert transform in ECG signal analysis,” Comput. Biol. Med., vol. 31, no. 5, pp. 399–406, 2001.<br>
[7] A. Martinez, R. Alcaraz, and J. J. Rieta, “Automatic electrocardiogram delineator based on the phasor transform of single lead recordings,” in<br>
Proc. Comput. Cardiol., 2010, pp. 987–990.<br>
[8] H. Vullings, M. Verhaegen, and H. Verbruggen, “Automated ECG segmentation with dynamic time warping,” in Proc. 20th Annu. Int. Conf. IEEE Eng. Med. Biol. Soc., Oct. 1998, vol. 1, pp. 163–166.<br>
[9] Z. Dokur, T. Olmez, M. Korurek, and E. Yazgan, “Detection of ECG waveforms by using artificial neural networks,” in Proc. 18th Annu. Int. Conf. IEEE Eng. Med. Biol. Soc., Oct. 1996, vol. 3, pp. 929–930.<br>
[10] S. Graja and J.-M. Boucher, “Hidden markov tree model applied to ecg delineation,” IEEE Trans. Instrum. Meas., vol. 54, no. 6, pp. 2163–2168,<br>
Dec. 2005.<br>
[11] E. B. Mazomenos, T.Chen, A. charyya, A.Bhattacharya, J.Rosengarten, and K. Maharatna, “A time-domain morphology and gradient based algorithm for ECG feature extraction,” in Proc. IEEE Int. Conf. Ind. Technol.,<br>
Mar. 2012, pp. 117–122.<br>
[12] Y. Sun, K. Luk Chan, and S.Muthu Krishnan, “ Characteristic wave detection in ECG signal using morphological transform,” BMC Cardiovascular Disorders, vol. 5, no. 1, 2005, Art. no. 28.<br>
[13] Corventis NUVANT Mobile Cardiac Telemetry System, 2017. [Online].Available: <a href="http://www.corventis.com/" target="_blank">http://www.corventis.com/</a><br>
[14] Vital Connect HealthPatch MD, 2017. [Online]. Available: <a href="http://www.vitalconnect.com/" target="_blank">http://www.vitalconnect.com/</a><br>
[15] Preventice BodyGuardian Remote Monitoring System, 2017. [Online].Available: <a href="http://www.preventice.com/" target="_blank">http://www.preventice.com/</a><br>
[16] Fitbit, 2017. [Online]. Available: <a href="https://www.fitbit.com/" target="_blank">https://www.fitbit.com/</a><br>
[17] Garmin, V´ıvo-Series, 2017. [Online]. Available: <a href="https://explore.garmin.com/en-US/vivo-fitness/" target="_blank">https://explore.garmin.com/en-US/vivo-fitness/</a><br>
[18] Polar, M400, 2017. [Online]. Available: <a href="https://www.polar.com/en/products/sport/M400" target="_blank">https://www.polar.com/en/products/sport/M400</a><br>
[19] Cronovo, 2017. [Online]. Available: <a href="http://www.cronovo.com/" target="_blank">http://www.cronovo.com/</a><br>
[20] QardioCore, 2017. [Online]. Available: <a href="https://www.getqardio.com/qardiocore-wearable-ecg-ekg-monitor-iphone/" target="_blank">https://www.getqardio.com/qardiocore-wearable-ecg-ekg-monitor-iphone/</a><br>
[21] F. Rinc´on, J. Recas, N. Khaled, and D. Atienza, “Development and evaluation ofmultileadwavelet-based ECGdelineation algorithms for embedded wireless sensor nodes,” IEEE Trans. Inf. Technol. Biomed., vol. 15, no. 6, pp. 854–863, Nov. 2011.<br>
[22] R. Braojos Lopez, G. Ansaloni, and D. Atienza Alonso, “A methodology for embedded classification of heartbeats using random projections,” in Proc. Des. Autom. Test Europe Conf., 2013, pp. 899–904.<br>
[23] N. Bayasi, T. Tekeste, H. Saleh, B. Mohammad, A. Khandoker, and M. Ismail, “Low-power ECG-based processor for predicting ventricular arrhythmia,” IEEE Trans. Very Large Scale Integr. Syst., vol. 24, no. 5, pp. 1962–1974, May 2016.<br>
[24] S. A. Guidera and J. S. Steinberg, “The signal-averaged P wave duration: A rapid and noninvasivemarker of risk of atrial fibrillation,” J. Amer. Coll. Cardiol., vol. 21, no. 7, pp. 1645–1651, 1993.<br>
[25] C. Saritha, V. Sukanya, and Y. N. Murthy, “ECG signal analysis using wavelet transforms,” Bulgarian J. Phys., vol. 35, no. 1, pp. 68–77, 2008.<br>
[26] R. B. Northrop, Noninvasive Instrumentation and Measurement inMedical Diagnosis. Boca Raton, FL, USA: CRC Press, 2001.<br>
[27] J. Van Alste and T. Schilder, “Removal of base-line wander and powerline interference from the ECG by an efficient FIR filter with a reduced number of taps,” IEEE Trans. Biomed. Eng., vol. BME-32, no. 12, pp. 1052–1060, Dec. 1985.<br>
[28] Y. Sun, K. L. Chan, and S. M. Krishnan, “ECG signal conditioning by morphological filtering,” Comput. Biol. Med., vol. 32, no. 6, pp. 465–479, 2002.<br>
[29] M. Gertsch, The ECG: A Two-Step Approach to Diagnosis. New York, NY, USA: Springer, 2003.<br>
[30] P. Laguna, R. G. Mark, A. Goldberg, and G. B. Moody, “A database for evaluation of algorithms for measurement of QT and other waveform intervals in the ECG,” in Proc. Comput. Cardiol., 1997, pp. 673–676.<br>
[31] A. L. Goldberger et al., “Physiobank, physiotoolkit, and physionet components<br>
of a new research resource for complex physiologic signals,” Circulation, vol. 101, no. 23, pp. e215–e220, 2000.<br>
[32] I. Silva and G. Moody, “An open-source toolbox for analysing and processing PhysioNet databases inMATLAB and Octave,” J. Open Res. Soft., vol. 2, no. 1, p. e27, 2014.<br>
[33] Testing and Reporting Performance Results of Cardiac Rhythm and ST Segment Measurement Algorithms. NSI/AAMI EC57:1998/®2008 (Revision of AAMI ECAR:1987), Association for the Advancement of Medical Instrumentation, 1999.<br>
[34] L.Y. Di Marco and L. Chiari, “Awavelet-basedECGdelineation algorithm for 32-bit integer online processing,” Biomed. Eng. Online, vol. 10, no. 1, 2011, Art. no. 23.<br>
[35] The CSE Working Party, “Recommendations for measurement standards in quantitative electrocardiography,” Eur. Heart J., vol. 6, no. 10, pp. 815–825, 1985.<br>
[36] S. Mehta and N. Lingayat, “Detection of P and T-waves in electrocardiogram,”<br>
in Proc. World Congr. Eng. Comput. Sci., 2008, pp. 22–24.<br>
[37] Texas Instruments, ADS1292, 2017. [Online]. Available: <a href="http://www.ti.com/product/ADS1292" target="_blank">http://www.ti.com/product/ADS1292</a><br>
[38] G. B. Moody and R. G. Mark, “The impact of the MIT-BIH arrhythmia database,” IEEE Eng. Med. Biol.Mag., vol. 20, no. 3, pp. 45–50, May/Jun. 2001.<br>
[39] G. B. Moody and R. G. Mark, “The MIT-BIH Arrhythmia Database on CD-ROM and software for use with it,” in Proc. Comput. Cardiol., 1990, pp. 185–188.<br>
[40] E. B. Mazomenos et al., “A low-complexity ECG feature extraction algorithm for mobile healthcare applications,” IEEE J. Biomed. Health Informat., vol. 17, no. 2, pp. 459–469, Mar. 2013.<br>
[41] Shimmer, 2017. [Online]. Available: <a href="http://www.shimmersensing.com" target="_blank">http://www.shimmersensing.com</a><br>
[42] J. Eriksson, A. Dunkels, N. Finne, F. Osterlind, and T. Voigt, “Mspsim- an extensible simulator for msp430-equipped sensor boards,” in Proc. Eur. Conf. Wireless Sens. Netw., 2007, p. 27.<br>
[43] R. Yates, Practical Considerations in Fixed-Point FIR Filter Implementations,Digital Signal Labs, Technical Reference, Mar. 2010.<br>
[44] IP LogiCORE FIR Compiler v5.0, Xilinx, San Jose, CA, USA, 2011.</p><h1 id="心得">心得</h1><p></p><div class="pdf" data-pdfurl="https://drive.google.com/uc?id=17yLVkUaywikpec2H2UYVZNEPUzVOsBlg"><div class="pdfobject-container"><embed class="pdfobject" src="https://drive.google.com/uc?id=17yLVkUaywikpec2H2UYVZNEPUzVOsBlg" type="application/pdf" style="overflow: auto; width: 100%; height: 400px;" internalinstanceid="59"></div></div><p></p><iframe src="https://drive.google.com/file/d/17yLVkUaywikpec2H2UYVZNEPUzVOsBlg/preview" width="640" height="480"></iframe></div>